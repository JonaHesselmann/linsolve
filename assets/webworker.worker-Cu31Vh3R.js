(function(){"use strict";importScripts("/linsolve//glpk.js"),self.onmessage=async function(i){console.log("Message received in worker:");const v=i.data;var l=glp_create_prob(),p=glp_mpl_alloc_wksp();_glp_mpl_init_rand(p,1);try{var O=glp_mpl_read_model_from_string(p,"model",v,0);glp_mpl_generate(p,null),glp_mpl_build_prob(p,l);var m=new SMCP({presolve:GLP_ON});glp_simplex(l,m);var u=new IOCP({presolve:GLP_ON});glp_intopt(l,u),glp_mpl_postsolve(p,l,GLP_MIP);const r=new Map,e=[];var _;switch(glp_mip_status(l)){case GLP_OPT:_="OPTIMAL";break;case GLP_UNDEF:_="UNDEFINED SOLUTION",e.push(_,"0");break;case GLP_INFEAS:_="INFEASIBLE SOLUTION",e.push(_,"0");break;case GLP_NOFEAS:_="NO FEASIBLE SOLUTION",e.push(_,"0");break;case GLP_FEAS:_="FEASIBLE SOLUTION",e[0];break;case GLP_UNBND:_="UNBOUNDED SOLUTION",e.push(_,"0");break}_=="OPTIMAL"?(console.log("OPTIMAL"),e.push("Optimal",glp_mip_obj_val(l)),console.log(glp_mip_obj_val(l))):console.log("no valid solution found"),r.set("Result",e),r.set("VariableTable",L()),r.set("ConstrainTable",b()),self.postMessage(r)}catch(r){r.line&&console.log(r.line),console.log(r.toString())}function L(){for(var r=[["Variable Name","Type","Lower Bound","Upper Bound","MIP Value","Objective Coefficient","Primal Value","Dual Value"]],e=1;e<=glp_get_num_cols(l);e++){var a;switch(glp_get_col_kind(l,e)){case GLP_CV:a="continuous";break;case GLP_IV:a="integer";break;case GLP_BV:a="binary";break}var o=glp_get_col_ub(l,e);o>=Number.MAX_VALUE&&(o="+inf");var n=glp_get_col_lb(l,e);n<=-Number.MAX_VALUE&&(n="-inf");var g=glp_get_col_name(l,e),s=glp_mip_col_val(l,e),t=glp_get_obj_coef(l,e),c=glp_get_col_prim(l,e),N=glp_get_col_dual(l,e),P=[g,a,n,o,s,t,c,N];r.push(P)}return r}function b(){for(var r=[["Constraint Name","MIP Value","Lower Bound","Upper Bound","Primal Value","Dual Value"]],e=1;e<=glp_get_num_rows(l);e++){var a=glp_get_row_ub(l,e);a>=Number.MAX_VALUE&&(a="+inf");var o=glp_get_row_lb(l,e);o<=-Number.MAX_VALUE&&(o="-inf");var n=glp_get_row_name(l,e),g=glp_mip_row_val(l,e),s=glp_get_row_prim(l,e),t=glp_get_row_dual(l,e),c=[n,g,o,a,s,t];r.push(c)}return r}}})();

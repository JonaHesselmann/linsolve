(function(){"use strict";importScripts("/linsolve//glpk.js"),self.onmessage=async function(c){const v=Date.now();console.log("Message received in worker:");const m=c.data;var l=glp_create_prob(),n=glp_mpl_alloc_wksp();_glp_mpl_init_rand(n,1);try{var I=glp_mpl_read_model_from_string(n,"model",m,0);glp_mpl_generate(n,null),glp_mpl_build_prob(n,l);var u=new SMCP({presolve:GLP_ON});glp_simplex(l,u);var L=new IOCP({presolve:GLP_ON});glp_intopt(l,L),glp_mpl_postsolve(n,l,GLP_MIP);const a=Date.now(),e=new Map,r=[];var _;switch(glp_mip_status(l)){case GLP_OPT:_="OPTIMAL";break;case GLP_UNDEF:_="UNDEFINED SOLUTION",r.push(_,"0");break;case GLP_INFEAS:_="INFEASIBLE SOLUTION",r.push(_,"0");break;case GLP_NOFEAS:_="NO FEASIBLE SOLUTION",r.push(_,"0");break;case GLP_FEAS:_="FEASIBLE SOLUTION",r[0];break;case GLP_UNBND:_="UNBOUNDED SOLUTION",r.push(_,"0");break}_=="OPTIMAL"?(console.log("OPTIMAL"),r.push("Optimal",glp_mip_obj_val(l)),console.log(glp_mip_obj_val(l))):console.log("no valid solution found"),e.set("Result",r),e.set("VariableTable",b()),e.set("ConstrainTable",N()),e.set("Walltime",a-v),self.postMessage(e)}catch(a){a.line&&console.log(a.line),console.log(a.toString())}function b(){for(var a=[["Variable Name","Type","Lower Bound","Upper Bound","MIP Value","Objective Coefficient","Primal Value","Dual Value"]],e=1;e<=glp_get_num_cols(l);e++){var r;switch(glp_get_col_kind(l,e)){case GLP_CV:r="continuous";break;case GLP_IV:r="integer";break;case GLP_BV:r="binary";break}var o=glp_get_col_ub(l,e);o>=Number.MAX_VALUE&&(o="+inf");var p=glp_get_col_lb(l,e);p<=-Number.MAX_VALUE&&(p="-inf");var g=glp_get_col_name(l,e),t=glp_mip_col_val(l,e),s=glp_get_obj_coef(l,e),i=glp_get_col_prim(l,e),P=glp_get_col_dual(l,e),f=[g,r,p,o,t,s,i,P];a.push(f)}return a}function N(){for(var a=[["Constraint Name","MIP Value","Lower Bound","Upper Bound","Primal Value","Dual Value"]],e=1;e<=glp_get_num_rows(l);e++){var r=glp_get_row_ub(l,e);r>=Number.MAX_VALUE&&(r="+inf");var o=glp_get_row_lb(l,e);o<=-Number.MAX_VALUE&&(o="-inf");var p=glp_get_row_name(l,e),g=glp_mip_row_val(l,e),t=glp_get_row_prim(l,e),s=glp_get_row_dual(l,e),i=[p,g,o,r,t,s];a.push(i)}return a}}})();
